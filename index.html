<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CeX Links — Cards with Thumbnails & Stock</title>
<style>
  :root {
    --bg: #0f1113;
    --panel: #21262b;
    --muted: #9aa3ad;
    --accent: #6fb8ff;
    --accent-2: #9ed1ff;
    --card-border: rgba(255,255,255,0.04);
  }

  *{box-sizing:border-box;}
  html, body{height:100%; margin:0;}
  body{
    font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif;
    background: rgb(22, 22, 22);
    color: #e6eef6;
    padding: 22px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    max-width: 1400px;
    margin: auto;
  }

  header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    margin-bottom: 18px;
  }

  h1{
    margin:0; 
    font-size:30px; 
    letter-spacing:0.2px;}
    
  .controls{
    font-size:13px; 
    color: var(--muted);
  }

  .grid {
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 14px;
    align-items: stretch;
  }

  .card {
    display: block;
    background: var(--panel);
    border: 1px solid var(--card-border);
    padding: 14px 16px;
    border-radius: 10px;
    text-decoration: none;
    color: inherit;
    transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
    min-height: 100px;
    box-shadow: 0 6px 18px rgba(2,6,12,0.6);
    display:flex;
    flex-direction: row;
    align-items: center;
  }

  .card:hover {
    transform: translateY(-6px);
    box-shadow: 0 14px 30px rgba(8,12,20,0.6);
    background: linear-gradient(180deg, rgba(111,184,255,0.03), rgba(255,255,255,0.01));
    border-color: rgba(111,184,255,0.12);
  }

  .thumbnail {
    width: 60px;
    height: 60px;
    flex-shrink: 0;
    margin-right: 14px;
    border-radius: 5px;
    background: var(--panel);
    object-fit: contain;
  }

  .content {
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-width: 0;
  }

  .title {
    font-weight: 700;
    color: #e9f6ff;
    font-size: 15px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .meta {
    margin-top: 6px;
    font-size: 13px;
    color: var(--muted);
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .meta .id {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
    font-size: 12px;
    padding: 3px 6px;
    border-radius: 6px;
    background: rgba(255,255,255,0.02);
    color: var(--muted);
  }

  .tag { 
    background: rgba(111,184,255,0.08); 
    color: var(--accent); 
    padding: 8px;
    border-radius: 10px;
  }

  .card:focus { outline: 2px solid rgba(111,184,255,0.16); outline-offset:3px; }

  @media (max-width:420px){
    .card{ padding:12px; min-height:64px }
    .title{ font-size:14px }
    .thumbnail{ width:48px; height:48px; margin-right:10px; }
  }
</style>
</head>
<body>
<header>
  <h1>CeX Links — Cards with Thumbnails & Stock</h1>
  <div class="controls">Click a card to open the link (opens in new tab)</div>
</header>

<main>
  <div class="grid" id="grid"></div>
</main>

<script>
const STORE_NAME = "Doncaster";

  const products = [
    { id: "5039036081054", url: "https://uk.webuy.com/product-detail?id=5039036081054&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=", tag: "BLU-RAY MOVIES" },
    { id: "5017239120039", url: "https://uk.webuy.com/product-detail?id=5017239120039&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=", tag: "BLU-RAY MOVIES" },
    { id: "5039036074162", url: "https://uk.webuy.com/product-detail?id=5039036074162&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=", tag: "BLU-RAY MOVIES" },
    { id: "5050582802528", url: "https://uk.webuy.com/product-detail?id=5050582802528&categoryName=DVD-TV-DOCUMENTARY&superCatName=FILM-TV&title=&queryID=E8BB09132571DF69595117603DAE48F9&position=1", tag: "DVD TV & Documentary" },
    { id: "5051892255448", url: "https://uk.webuy.com/product-detail?id=5051892255448&categoryName=BLU-RAY-4K&superCatName=FILM-TV&title=&queryID=7FCF0210469CC3FCAE46969222BA71E5&position=2", tag: "BLU-RAY 4K" },
    { id: "805529493698", url: "https://uk.webuy.com/product-detail?id=805529493698&categoryName=XBOX-GAMES&superCatName=GAMING&title=", tag: "XBOX GAMES" },
    { id: "5039036060486", url: "https://uk.webuy.com/product-detail?id=5039036060486&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=", tag: "BLU-RAY MOVIES" },
    { id: "5060797576411", url: "https://uk.webuy.com/product-detail?id=5060797576411&categoryName=BLU-RAY-TV-DOCUMENTARY&superCatName=FILM-TV&title=", tag: "TV / DOC" },
    { id: "8717418592660", url: "https://uk.webuy.com/product-detail?id=8717418592660&categoryName=BLU-RAY-4K&superCatName=FILM-TV&title=", tag: "BLU-RAY 4K" },
    { id: "8717418592653", url: "https://uk.webuy.com/product-detail?id=8717418592653&categoryName=BLU-RAY-KIDS&superCatName=FILM-TV&title=", tag: "BLU-RAY KIDS" },
    { id: "5061049330256", url: "https://uk.webuy.com/product-detail?id=5061049330256&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=&queryID=9E3589C1E60D6FA8939C833FB5876F00&position=3", tag: "BLU-RAY MOVIES" },
    { id: "5060223761633S", url: "https://uk.webuy.com/product-detail?id=5060223761633S&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=", tag: "BLU-RAY MOVIES" },
    { id: "5030930048341", url: "https://uk.webuy.com/product-detail?id=5030930048341&categoryName=PC-GAMES&superCatName=GAMING&title=", tag: "PC GAMES" },
    { id: "5053083202743", url: "https://uk.webuy.com/product-detail?id=5053083202743&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=", tag: "BLU-RAY MOVIES" },
    { id: "5055201820983", url: "https://uk.webuy.com/product-detail?id=5055201820983&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=", tag: "BLU-RAY MOVIES" },
    { id: "7321900183215", url: "https://uk.webuy.com/product-detail?id=7321900183215&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=", tag: "BLU-RAY MOVIES" },
    { id: "5050582805895", url: "https://uk.webuy.com/product-detail?id=5050582805895&categoryName=BLU-RAY-MOVIES&superCatName=FILM-TV&title=", tag: "BLU-RAY MOVIES" },
    { id: null, url: "https://uk.webuy.com/search?stext=michael+jackson&sortBy=prod_cex_uk_price_desc&stores=Doncaster~Scarborough~Sheffield~Rotherham", tag: "SEARCH", titleOverride: "Search: Michael Jackson — CeX Doncaster" },
    { id: null, url: "https://uk.webuy.com/search?stext=viena+blood&stores=Doncaster~Scarborough~Sheffield~Rotherham", tag: "SEARCH", titleOverride: "Search: Viena Blood — CeX" },
    { id: null, url: "https://uk.webuy.com/search?stext=All+Quiet+On+The+Western+Front&stores=Doncaster~Scarborough~Sheffield~Rotherham", tag: "SEARCH", titleOverride: "Search: All Quiet On The Western Front — CeX Doncaster" },
    { id: null, url: "https://uk.webuy.com/search?stext=shrek&stores=Doncaster~Scarborough~Sheffield~Rotherham&categoryFriendlyName=Blu-Ray+Kids", tag: "SEARCH", titleOverride: "Search: Shrek — CeX Doncaster" },
    { id: null, url: "https://uk.webuy.com/search?stext=beetlejuice&stores=Doncaster~Scarborough~Sheffield~Rotherham&categoryFriendlyName=Blu-Ray+4K~Blu-Ray+Movies", tag: "SEARCH", titleOverride: "Search: Beetlejuice — CeX Doncaster" },
    { id: null, url: "https://uk.webuy.com/search?stext=steelbook&stores=Doncaster", tag: "SEARCH", titleOverride: "Search: Steelbooks — CeX Doncaster" },
  ];

async function fetchProductDetails(sku) {
  if (!sku) return null;
  try {
    const apiUrl = `https://corsproxy.io/?https://wss2.cex.uk.webuy.io/v3/boxes/${sku}/detail`;
    const resp = await fetch(apiUrl);
    if (!resp.ok) return null;
    const json = await resp.json();
    return json?.response?.data?.boxDetails?.[0] ?? null;
  } catch (e) { console.error("Error fetching details for SKU", sku, e); return null; }
}

async function init() {
  const grid = document.getElementById("grid");
  for (const p of products) {
    const detail = await fetchProductDetails(p.id);
    const imgUrl = detail?.imageUrls?.medium;
    const title = p.titleOverride ?? detail?.boxName ?? `ID: ${p.id ?? ""}`;

    const a = document.createElement("a");
    a.className = "card";
    a.href = p.url;
    a.target = "_blank";
    a.rel = "noopener";

    const img = document.createElement("img");
    img.className = "thumbnail";
    img.src = imgUrl || "";
    if (!imgUrl) img.style.background = "rgba(255,255,255,0.05)";

    const content = document.createElement("div");
    content.className = "content";

    const titleEl = document.createElement("div");
    titleEl.className = "title";
    titleEl.textContent = title;
    content.appendChild(titleEl);

    const meta = document.createElement("div");
    meta.className = "meta";

    const idEl = document.createElement("div");
    idEl.className = "id";
    idEl.textContent = p.id ? `ID: ${p.id}` : "search";
    meta.appendChild(idEl);

    const tagEl = document.createElement("div");
    tagEl.className = "tag";
    tagEl.textContent = p.tag;
    meta.appendChild(tagEl);

    content.appendChild(meta);
    a.appendChild(img);
    a.appendChild(content);
    grid.appendChild(a);
  }
}

init();
</script>
</body>
</html>
